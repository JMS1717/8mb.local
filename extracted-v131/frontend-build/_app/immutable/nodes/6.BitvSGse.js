import{f as h,a as y}from"../chunks/BZqCPlBW.js";import"../chunks/CS0-jjX0.js";import{o as fi}from"../chunks/BPGtCBdR.js";import{F as mi,G as g,I as l,J as i,z as e,K as yi,L as P,M as u,N as a,O as x,P as s,Q as L,D as hi}from"../chunks/U2DDJ_0W.js";import{e as w,s as f}from"../chunks/CY5WxPnE.js";import{i as N}from"../chunks/DI9HNUez.js";import{e as fe,r as _,i as me}from"../chunks/C9DCMbO9.js";import{b as S,a as E,c as Q}from"../chunks/DsOkiI6p.js";import{i as gi}from"../chunks/CQGLq4BK.js";var xi=h('<div class="banner svelte-1i19ct2"><div>Codec visibility synced from hardware tests</div> <button class="svelte-1i19ct2">Dismiss</button></div>'),wi=h('<div class="msg ok svelte-1i19ct2"> </div>'),ki=h('<div class="msg err svelte-1i19ct2"> </div>'),Si=h('<div style="margin-top:12px"><label class="label svelte-1i19ct2" for="confirmpass">Confirm new password</label> <input id="confirmpass" class="input svelte-1i19ct2" type="password"/></div>'),ji=h('<div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Authentication</div> <div class="switch svelte-1i19ct2" style="margin-bottom:12px"><input id="auth_enabled" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="auth_enabled" style="margin:0">Require authentication</label></div> <div class="row svelte-1i19ct2"><div><label class="label svelte-1i19ct2" for="username">Username</label> <input id="username" class="input svelte-1i19ct2" type="text" placeholder="admin"/></div> <div><label class="label svelte-1i19ct2" for="newpass">New password (optional)</label> <input id="newpass" class="input svelte-1i19ct2" type="password"/></div></div> <!> <div style="margin-top:12px"><button class="btn svelte-1i19ct2"> </button></div></div>'),Pi=h(`<div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Authentication</div> <p class="label svelte-1i19ct2" style="color:#9ca3af; margin-bottom:12px">Authentication is currently disabled. To enable authentication and secure your instance, you'll need to configure it via the Docker container environment variables or configuration file.</p> <p class="label svelte-1i19ct2" style="color:#9ca3af; font-size:13px">See the <a href="https://github.com/JMS1717/8mb.local" target="_blank" rel="noopener noreferrer" style="color:#3b82f6; text-decoration:underline">documentation</a> for setup instructions.</p></div>`),Ci=h('<div class="msg err svelte-1i19ct2"> </div>'),Ni=h('<span class="text-green-400">PASS</span>'),Ai=h('<span class="text-red-400">FAIL</span>'),Vi=h('<li class="flex items-center justify-between"><span> <span class="opacity-60"> </span></span> <!></li>'),Ti=h('<ul class="text-sm space-y-1"></ul>'),Hi=h('<p class="label svelte-1i19ct2" style="color:#9ca3af">No test results available yet.</p>'),Ui=h('<a href="/history" class="btn alt svelte-1i19ct2" style="text-decoration:none; display:inline-block">View History ‚Üí</a>'),zi=h('<span style="display:inline-flex; align-items:center; gap:6px; background:#1f2937; border:1px solid #374151; border-radius:8px; padding:6px 8px"> <button class="btn svelte-1i19ct2" style="background:#374151; padding:4px 8px">Remove</button></span>'),Ei=h("<option> </option>"),Fi=h('<div style="background:#1f2937; border:1px solid #374151; border-radius:8px; padding:10px"><div style="font-weight:600"> </div> <div style="font-size:12px; color:#9ca3af"> </div></div> <div style="display:flex; align-items:center"><button class="btn svelte-1i19ct2" style="background:#374151">Delete</button></div>',1),Mi=h('<div style="margin-top:12px"><div class="row svelte-1i19ct2" style="grid-template-columns: 1fr auto; gap:8px"></div></div>'),qi=h('<div class="container svelte-1i19ct2"><div class="hdr svelte-1i19ct2"><h1 class="title svelte-1i19ct2" style="font-size:24px">Settings</h1> <a href="/" class="btn svelte-1i19ct2" style="text-decoration:none; background:#374151">‚Üê Back</a></div> <!> <!> <!> <!> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Available Codecs</div> <p class="label svelte-1i19ct2" style="margin-bottom:16px; color:#9ca3af">Select which codecs appear in the compression page dropdown. Enable codecs that your hardware supports. <a href="/gpu-support" style="color:#3b82f6; text-decoration:underline">View GPU encoding support ‚Üí</a></p> <div style="margin-bottom:20px"><h3 style="color:#10b981; font-weight:600; font-size:15px; margin-bottom:8px">NVIDIA (NVENC)</h3> <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px"><div class="switch svelte-1i19ct2"><input id="av1_nvenc" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="av1_nvenc" style="margin:0">AV1 (RTX 40/50)</label></div> <div class="switch svelte-1i19ct2"><input id="hevc_nvenc" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="hevc_nvenc" style="margin:0">HEVC (H.265)</label></div> <div class="switch svelte-1i19ct2"><input id="h264_nvenc" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="h264_nvenc" style="margin:0">H.264</label></div></div></div> <div style="margin-bottom:20px"><h3 style="color:#3b82f6; font-weight:600; font-size:15px; margin-bottom:8px">Intel (Quick Sync / QSV)</h3> <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px"><div class="switch svelte-1i19ct2"><input id="av1_qsv" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="av1_qsv" style="margin:0">AV1 (Arc GPUs)</label></div> <div class="switch svelte-1i19ct2"><input id="hevc_qsv" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="hevc_qsv" style="margin:0">HEVC (H.265)</label></div> <div class="switch svelte-1i19ct2"><input id="h264_qsv" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="h264_qsv" style="margin:0">H.264</label></div></div></div> <div style="margin-bottom:20px"><h3 style="color:#ef4444; font-weight:600; font-size:15px; margin-bottom:8px">AMD/Intel (VAAPI - Linux only)</h3> <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px"><div class="switch svelte-1i19ct2"><input id="av1_vaapi" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="av1_vaapi" style="margin:0">AV1 VAAPI</label></div> <div class="switch svelte-1i19ct2"><input id="hevc_vaapi" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="hevc_vaapi" style="margin:0">HEVC VAAPI</label></div> <div class="switch svelte-1i19ct2"><input id="h264_vaapi" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="h264_vaapi" style="margin:0">H.264 VAAPI</label></div></div></div> <div style="margin-bottom:20px"><h3 style="color:#9ca3af; font-weight:600; font-size:15px; margin-bottom:8px">CPU (Software Encoding)</h3> <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px"><div class="switch svelte-1i19ct2"><input id="libaom_av1" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="libaom_av1" style="margin:0">AV1 (Highest Quality)</label></div> <div class="switch svelte-1i19ct2"><input id="libx265" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="libx265" style="margin:0">HEVC (H.265)</label></div> <div class="switch svelte-1i19ct2"><input id="libx264" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="libx264" style="margin:0">H.264</label></div></div></div> <div style="margin-top:16px"><button class="btn svelte-1i19ct2"> </button></div></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Hardware Tests</div> <p class="label svelte-1i19ct2" style="margin-bottom:12px; color:#9ca3af">Validate hardware encoders/decoders inside the worker. Useful after driver updates or container restarts.</p> <!> <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:12px;"><button class="btn svelte-1i19ct2"> </button> <button class="btn alt svelte-1i19ct2">Refresh results</button></div> <!></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">üìä Compression History</div> <p class="label svelte-1i19ct2" style="margin-bottom:16px; color:#9ca3af">Track completed compression jobs with metadata (filenames, sizes, codecs, presets). No video files are stored.</p> <div class="switch svelte-1i19ct2" style="margin-bottom:16px"><input id="history_enabled" type="checkbox" class="svelte-1i19ct2"/> <label class="label svelte-1i19ct2" for="history_enabled" style="margin:0">Enable compression history tracking</label></div> <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap"><button class="btn svelte-1i19ct2"> </button> <!></div></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">File size buttons</div> <p class="label svelte-1i19ct2" style="color:#9ca3af">Customize the quick-select file size buttons shown on the main screen.</p> <div style="display:flex; flex-wrap:wrap; gap:8px; margin:10px 0"></div> <div class="row svelte-1i19ct2"><div><label class="label svelte-1i19ct2">Add size (MB)</label> <input class="input svelte-1i19ct2" type="number" min="1"/></div> <div style="display:flex; align-items:flex-end"><button class="btn svelte-1i19ct2">Add</button></div></div> <div style="margin-top:12px"><button class="btn alt svelte-1i19ct2"> </button></div></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Preset profiles</div> <p class="label svelte-1i19ct2" style="color:#9ca3af">Create multiple presets you can select on the main screen (at least 5 supported).</p> <div style="margin-bottom:8px"><label class="label svelte-1i19ct2">Default preset</label> <div class="row svelte-1i19ct2"><select class="select svelte-1i19ct2"></select> <button class="btn svelte-1i19ct2"> </button></div></div> <div style="margin-top:12px"><div class="row svelte-1i19ct2"><div><label class="label svelte-1i19ct2">New preset name</label> <input class="input svelte-1i19ct2" type="text" placeholder="e.g., H265 9.7MB (NVENC)"/></div> <div style="display:flex; align-items:flex-end"><button class="btn svelte-1i19ct2"> </button></div></div></div> <!></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">File retention</div> <p class="label svelte-1i19ct2" style="color:#9ca3af">How long files remain on the server before automatic deletion.</p> <div class="row svelte-1i19ct2"><div><label class="label svelte-1i19ct2">Hours</label> <input class="input svelte-1i19ct2" type="number" min="0"/></div> <div style="display:flex; align-items:flex-end"><button class="btn svelte-1i19ct2"> </button></div></div></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">üöÄ Worker Concurrency</div> <p class="label svelte-1i19ct2" style="color:#9ca3af; margin-bottom: 12px;">Maximum number of jobs that can compress simultaneously. Higher values allow more parallel jobs but require more GPU/CPU resources.</p> <div class="row svelte-1i19ct2"><div><label class="label svelte-1i19ct2">Max concurrent jobs</label> <input class="input svelte-1i19ct2" type="number" min="1" max="20"/></div> <div style="display:flex; align-items:flex-end"><button class="btn svelte-1i19ct2"> </button></div></div> <details style="margin-top: 12px; background: #1f2937; border: 1px solid #374151; border-radius: 8px; padding: 12px;"><summary style="cursor: pointer; font-weight: 600; color: #60a5fa; user-select: none;">üí° Guidelines & Recommendations</summary> <div style="margin-top: 8px; font-size: 14px; color: #d1d5db; line-height: 1.6;"><p style="margin-bottom: 8px;"><strong>Hardware-based recommendations:</strong></p> <ul style="margin-left: 20px; margin-bottom: 12px;"><li><strong>Quadro RTX 4000 / RTX 3060+:</strong> 6-10 concurrent jobs (excellent NVENC throughput)</li> <li><strong>GTX 1660 / RTX 2060:</strong> 3-5 concurrent jobs (good NVENC performance)</li> <li><strong>GTX 1050 Ti / Entry-level:</strong> 2-3 concurrent jobs (basic NVENC)</li> <li><strong>CPU-only encoding:</strong> 1-2 jobs per 4 CPU cores (very slow, high CPU usage)</li> <li><strong>Intel/AMD VAAPI:</strong> 4-8 concurrent jobs (depends on iGPU/dGPU)</li></ul> <p style="margin-bottom: 8px;"><strong>Performance considerations:</strong></p> <ul style="margin-left: 20px; margin-bottom: 12px;"><li><strong>NVENC hardware limit:</strong> Most NVIDIA GPUs support 2-3 NVENC sessions natively, but driver unlocks allow unlimited sessions</li> <li><strong>Memory usage:</strong> Each job uses ~200-500MB RAM. Monitor system memory with high concurrency</li> <li><strong>GPU memory:</strong> Each NVENC encode uses ~100-200MB VRAM. Check available VRAM</li> <li><strong>Disk I/O:</strong> Higher concurrency increases disk read/write. Use SSD for best performance</li></ul> <p style="margin-bottom: 8px;"><strong>Testing recommendations:</strong></p> <ul style="margin-left: 20px;"><li>Start with 4 concurrent jobs and gradually increase while monitoring GPU utilization</li> <li>Watch for thermal throttling on high concurrency (GPU temps >80¬∞C)</li> <li>Monitor job completion times - if they increase significantly, reduce concurrency</li> <li>Check queue page during high load to see which jobs are running simultaneously</li></ul> <p style="margin-top: 12px; padding: 8px; background: #fef3c7; color: #92400e; border-radius: 4px;">‚ö†Ô∏è <strong>Note:</strong> Container restart required for changes to take effect. Current running jobs will complete before new setting applies.</p></div></details></div> <div class="card svelte-1i19ct2"><div class="title svelte-1i19ct2">Default presets</div> <div><label class="label svelte-1i19ct2" for="targetmb">Default target size (MB)</label> <input id="targetmb" class="input svelte-1i19ct2" type="number" min="1"/></div> <div class="row svelte-1i19ct2" style="margin-top:12px"><div><label class="label svelte-1i19ct2" for="vcodec">Video codec</label> <select id="vcodec" class="select svelte-1i19ct2"><option>AV1 (NVENC)</option><option>HEVC (NVENC)</option><option>H.264 (NVENC)</option><option>AV1 (CPU)</option><option>HEVC (CPU)</option><option>H.264 (CPU)</option></select></div> <div><label class="label svelte-1i19ct2" for="acodec">Audio codec</label> <select id="acodec" class="select svelte-1i19ct2"><option>Opus</option><option>AAC</option></select></div></div> <div class="row svelte-1i19ct2" style="margin-top:12px"><div><label class="label svelte-1i19ct2" for="preset">Speed/quality preset</label> <select id="preset" class="select svelte-1i19ct2"><option>P1 (Fastest)</option><option>P2</option><option>P3</option><option>P4</option><option>P5</option><option>P6 (Balanced)</option><option>P7 (Best quality)</option></select></div> <div><label class="label svelte-1i19ct2" for="kbps">Audio bitrate (kbps)</label> <select id="kbps" class="select svelte-1i19ct2"><option>64</option><option>96</option><option>128</option><option>160</option><option>192</option><option>256</option></select></div></div> <div class="row svelte-1i19ct2" style="margin-top:12px"><div><label class="label svelte-1i19ct2" for="container">Container</label> <select id="container" class="select svelte-1i19ct2"><option>MP4</option><option>MKV</option></select></div> <div><label class="label svelte-1i19ct2" for="tune">Tune</label> <select id="tune" class="select svelte-1i19ct2"><option>High Quality</option><option>Low Latency</option><option>Ultra Low Latency</option><option>Lossless</option></select></div></div> <div style="margin-top:12px"><button class="btn alt svelte-1i19ct2"> </button></div></div> <div class="card svelte-1i19ct2" style="padding:8px"><details><summary style="cursor:pointer; list-style:none; display:flex; align-items:center; gap:8px"><span class="title svelte-1i19ct2" style="margin:0; font-size:18px">Support the Project</span> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"></path></svg></summary> <div style="margin-top:12px"><p class="label svelte-1i19ct2" style="color:#cbd5e1">If 8mb.local helps you, a small gesture goes a long way. Thank you for supporting continued development!</p> <div style="display:flex; flex-wrap:wrap; gap:10px; margin-top:10px"><a class="btn svelte-1i19ct2" style="text-decoration:none" href="https://www.paypal.com/paypalme/jasonselsley" target="_blank" rel="noopener noreferrer">Support via PayPal</a> <a class="btn svelte-1i19ct2" style="text-decoration:none; background:#374151" href="https://github.com/JMS1717/8mb.local" target="_blank" rel="noopener noreferrer">Star on GitHub</a></div></div></details></div></div>');function Xi(Ha,Ua){mi(Ua,!1);let r=u(!1),b=u(""),c=u(""),Y=u(!1),ye=u(!1),H=u(!1),Z=u("admin"),U=u(""),oe=u(""),F=u(25),M=u("av1_nvenc"),q=u("libopus"),I=u("p6"),B=u(128),R=u("mp4"),D=u("hq"),v=u({h264_nvenc:!0,hevc_nvenc:!0,av1_nvenc:!0,h264_qsv:!0,hevc_qsv:!0,av1_qsv:!0,h264_vaapi:!0,hevc_vaapi:!0,av1_vaapi:!0,libx264:!0,libx265:!0,libaom_av1:!0}),G=u([]),X=u(null),A=u([]),z=u(null),K=u(""),ne=u(1),W=u(4),$=u([]),ee=u(!1),te=u("");fi(async()=>{try{const[t,o,d,m]=await Promise.all([fetch("/api/settings/auth"),fetch("/api/settings/presets"),fetch("/api/settings/codecs"),fetch("/api/settings/history")]);if(t.ok){const n=await t.json();a(H,!!n.auth_enabled),a(Z,n.auth_user||"admin")}if(o.ok){const n=await o.json();a(F,n.target_mb),a(M,n.video_codec),a(q,n.audio_codec),a(I,n.preset),a(B,n.audio_kbps),a(R,n.container),a(D,n.tune)}if(d.ok){const n=await d.json();a(v,n)}if(m.ok){const n=await m.json();a(Y,n.enabled||!1)}try{const n=await fetch("/api/settings/size-buttons");if(n.ok){const p=await n.json();a(G,p.buttons||[])}}catch{}try{const n=await fetch("/api/settings/preset-profiles");if(n.ok){const p=await n.json();a(A,p.profiles||[]),a(z,p.default||null)}}catch{}try{const n=await fetch("/api/settings/retention-hours");if(n.ok){const p=await n.json();a(ne,p.hours??1)}}catch{}try{const n=await fetch("/api/settings/worker-concurrency");if(n.ok){const p=await n.json();a(W,p.concurrency??4)}}catch{}try{const n=await fetch("/api/system/encoder-tests");if(n.ok){const p=await n.json();a($,p.results||[])}}catch{}try{const n=await fetch("/api/startup/info");if(n.ok){const p=await n.json(),j=p.boot_id,C=!!p.codec_visibility_synced,V=window.localStorage.getItem("8mblocal:lastSeenBootId");C&&j&&j!==V&&a(ye,!0)}}catch{}}catch{a(c,"Failed to load settings")}});async function za(){a(te,""),a(ee,!0);try{const t=await fetch("/api/system/encoder-tests/rerun",{method:"POST"});if(t.ok){const o=await t.json();a($,o.results||[]),a(b,"Hardware tests re-ran successfully")}else{const o=await t.json().catch(()=>({}));a(te,o.detail||"Failed to re-run hardware tests")}}catch{a(te,"Failed to re-run hardware tests")}finally{a(ee,!1)}}async function Ea(){if(a(c,""),a(b,""),e(H)&&!e(Z).trim()){a(c,"Username is required when authentication is enabled");return}if(e(H)&&e(U)&&e(U)!==e(oe)){a(c,"Passwords do not match");return}a(r,!0);try{const t={auth_enabled:e(H),auth_user:e(Z).trim()};e(H)&&e(U)&&(t.auth_pass=e(U));const o=await fetch("/api/settings/auth",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(o.ok){const d=await o.json();a(b,d.message||"Saved authentication settings"),a(U,""),a(oe,"")}else{const d=await o.json();a(c,d.detail||"Failed to save authentication")}}catch{a(c,"Failed to save authentication")}finally{a(r,!1)}}async function Fa(){if(a(c,""),a(b,""),e(F)<1){a(c,"Target size must be at least 1 MB");return}a(r,!0);try{const t=await fetch("/api/settings/presets",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({target_mb:e(F),video_codec:e(M),audio_codec:e(q),preset:e(I),audio_kbps:e(B),container:e(R),tune:e(D)})});if(t.ok){const o=await t.json();a(b,o.message||"Saved default presets")}else{const o=await t.json();a(c,o.detail||"Failed to save presets")}}catch{a(c,"Failed to save presets")}finally{a(r,!1)}}async function Ma(){a(c,""),a(b,""),a(r,!0);try{const t=await fetch("/api/settings/codecs",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(v))});if(t.ok){const o=await t.json();a(b,o.message||"Saved codec visibility settings")}else{const o=await t.json();a(c,o.detail||"Failed to save codec settings")}}catch{a(c,"Failed to save codec settings")}finally{a(r,!1)}}async function qa(){a(c,""),a(b,""),a(r,!0);try{const t=await fetch("/api/settings/history",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:e(Y)})});if(t.ok){const o=await t.json();a(b,o.message||"Saved history settings")}else{const o=await t.json();a(c,o.detail||"Failed to save history settings")}}catch{a(c,"Failed to save history settings")}finally{a(r,!1)}}async function Ia(){a(c,""),a(b,""),a(r,!0);try{const t=await fetch("/api/settings/size-buttons",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({buttons:e(G)})});if(t.ok)a(b,"Saved size buttons");else{const o=await t.json();a(c,o.detail||"Failed to save size buttons")}}catch{a(c,"Failed to save size buttons")}finally{a(r,!1)}}function Ba(t){a(G,e(G).filter((o,d)=>d!==t))}function Ra(){e(X)&&e(X)>0&&(a(G,Array.from(new Set([...e(G),Number(e(X))])).sort((t,o)=>t-o)),a(X,null))}async function Da(){if(!e(K).trim()){a(c,"Preset name required");return}a(r,!0),a(c,""),a(b,"");try{const t=await fetch("/api/settings/preset-profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(K).trim(),target_mb:e(F),video_codec:e(M),audio_codec:e(q),preset:e(I),audio_kbps:e(B),container:e(R),tune:e(D)})});if(t.ok)a(b,"Added preset"),a(A,[...e(A),{name:e(K).trim(),target_mb:e(F),video_codec:e(M),audio_codec:e(q),preset:e(I),audio_kbps:e(B),container:e(R),tune:e(D)}]),a(K,"");else{const o=await t.json();a(c,o.detail||"Failed to add preset")}}catch{a(c,"Failed to add preset")}finally{a(r,!1)}}async function Ga(t){a(r,!0),a(c,""),a(b,"");try{const o=await fetch(`/api/settings/preset-profiles/${encodeURIComponent(t)}`,{method:"DELETE"});if(o.ok)a(b,"Deleted preset"),a(A,e(A).filter(d=>d.name!==t)),e(z)===t&&a(z,null);else{const d=await o.json();a(c,d.detail||"Failed to delete preset")}}catch{a(c,"Failed to delete preset")}finally{a(r,!1)}}async function Oa(){if(!e(z)){a(c,"Select a default preset");return}a(r,!0),a(c,""),a(b,"");try{const t=await fetch("/api/settings/preset-profiles/default",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(z)})});if(t.ok)a(b,"Default preset updated");else{const o=await t.json();a(c,o.detail||"Failed to set default")}}catch{a(c,"Failed to set default")}finally{a(r,!1)}}async function Ja(){a(r,!0),a(c,""),a(b,"");try{const t=await fetch("/api/settings/retention-hours",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({hours:e(ne)})});if(t.ok)a(b,"Saved retention hours");else{const o=await t.json();a(c,o.detail||"Failed to save retention")}}catch{a(c,"Failed to save retention")}finally{a(r,!1)}}async function La(){if(a(r,!0),a(c,""),a(b,""),e(W)<1){a(c,"Concurrency must be at least 1"),a(r,!1);return}if(e(W)>20){a(c,"Concurrency should not exceed 20"),a(r,!1);return}try{const t=await fetch("/api/settings/worker-concurrency",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({concurrency:e(W)})});if(t.ok){const o=await t.json();a(b,o.message||"Saved worker concurrency. Restart container to apply.")}else{const o=await t.json();a(c,o.detail||"Failed to save concurrency")}}catch{a(c,"Failed to save concurrency")}finally{a(r,!1)}}gi();var he=qi(),Vt=i(l(he),2);{var Qa=t=>{var o=xi(),d=i(l(o),2);s(o),w("click",d,()=>{try{fetch("/api/startup/info").then(n=>n.ok?n.json():null).then(n=>{const p=n==null?void 0:n.boot_id;p&&window.localStorage.setItem("8mblocal:lastSeenBootId",p)})}catch{}a(ye,!1)}),y(t,o)};N(Vt,t=>{e(ye)&&t(Qa)})}var Tt=i(Vt,2);{var Xa=t=>{var o=wi(),d=l(o,!0);s(o),g(()=>f(d,e(b))),y(t,o)};N(Tt,t=>{e(b)&&t(Xa)})}var Ht=i(Tt,2);{var Ka=t=>{var o=ki(),d=l(o,!0);s(o),g(()=>f(d,e(c))),y(t,o)};N(Ht,t=>{e(c)&&t(Ka)})}var Ut=i(Ht,2);{var Wa=t=>{var o=ji(),d=i(l(o),2),m=l(d);_(m),x(2),s(d);var n=i(d,2),p=l(n),j=i(l(p),2);_(j),s(p);var C=i(p,2),O=i(l(C),2);_(O),s(C),s(n);var V=i(n,2);{var se=T=>{var At=Si(),Ta=i(l(At),2);_(Ta),s(At),E(Ta,()=>e(oe),_i=>a(oe,_i)),y(T,At)};N(V,T=>{e(U)&&T(se)})}var J=i(V,2),k=l(J),le=l(k,!0);s(k),s(J),s(o),g(()=>{k.disabled=e(r),f(le,e(r)?"Saving‚Ä¶":"Save authentication")}),S(m,()=>e(H),T=>a(H,T)),E(j,()=>e(Z),T=>a(Z,T)),E(O,()=>e(U),T=>a(U,T)),w("click",k,Ea),y(t,o)},$a=t=>{var o=Pi();y(t,o)};N(Ut,t=>{e(H)?t(Wa):t($a,!1)})}var ge=i(Ut,2),xe=i(l(ge),4),zt=i(l(xe),2),we=l(zt),Et=l(we);_(Et),x(2),s(we);var ke=i(we,2),Ft=l(ke);_(Ft),x(2),s(ke);var Mt=i(ke,2),qt=l(Mt);_(qt),x(2),s(Mt),s(zt),s(xe);var Se=i(xe,2),It=i(l(Se),2),je=l(It),Bt=l(je);_(Bt),x(2),s(je);var Pe=i(je,2),Rt=l(Pe);_(Rt),x(2),s(Pe);var Dt=i(Pe,2),Gt=l(Dt);_(Gt),x(2),s(Dt),s(It),s(Se);var Ce=i(Se,2),Ot=i(l(Ce),2),Ne=l(Ot),Jt=l(Ne);_(Jt),x(2),s(Ne);var Ae=i(Ne,2),Lt=l(Ae);_(Lt),x(2),s(Ae);var Qt=i(Ae,2),Xt=l(Qt);_(Xt),x(2),s(Qt),s(Ot),s(Ce);var Ve=i(Ce,2),Kt=i(l(Ve),2),Te=l(Kt),Wt=l(Te);_(Wt),x(2),s(Te);var He=i(Te,2),$t=l(He);_($t),x(2),s(He);var Yt=i(He,2),Zt=l(Yt);_(Zt),x(2),s(Yt),s(Kt),s(Ve);var ea=i(Ve,2),re=l(ea),Ya=l(re,!0);s(re),s(ea),s(ge);var Ue=i(ge,2),ta=i(l(Ue),4);{var Za=t=>{var o=Ci(),d=l(o,!0);s(o),g(()=>f(d,e(te))),y(t,o)};N(ta,t=>{e(te)&&t(Za)})}var ze=i(ta,2),ae=l(ze),ei=l(ae,!0);s(ae);var aa=i(ae,2);s(ze);var ti=i(ze,2);{var ai=t=>{var o=Ti();fe(o,5,()=>e($),me,(d,m)=>{var n=Vi(),p=l(n),j=l(p),C=i(j),O=l(C);s(C),s(p);var V=i(p,2);{var se=k=>{var le=Ni();y(k,le)},J=k=>{var le=Ai();y(k,le)};N(V,k=>{e(m).passed?k(se):k(J,!1)})}s(n),g(()=>{f(j,`${e(m).codec??""} `),f(O,`(${e(m).actual_encoder??""})`)}),y(d,n)}),s(o),y(t,o)},ii=t=>{var o=Hi();y(t,o)};N(ti,t=>{e($)&&e($).length?t(ai):t(ii,!1)})}s(Ue);var Ee=i(Ue,2),Fe=i(l(Ee),4),ia=l(Fe);_(ia),x(2),s(Fe);var sa=i(Fe,2),ie=l(sa),si=l(ie,!0);s(ie);var li=i(ie,2);{var oi=t=>{var o=Ui();y(t,o)};N(li,t=>{e(Y)&&t(oi)})}s(sa),s(Ee);var Me=i(Ee,2),qe=i(l(Me),4);fe(qe,5,()=>e(G),me,(t,o,d)=>{var m=zi(),n=l(m),p=i(n);s(m),g(()=>f(n,`${e(o)??""} MB `)),w("click",p,()=>Ba(d)),y(t,m)}),s(qe);var Ie=i(qe,2),Be=l(Ie),la=i(l(Be),2);_(la),s(Be);var oa=i(Be,2),na=l(oa);s(oa),s(Ie);var ra=i(Ie,2),ce=l(ra),ni=l(ce,!0);s(ce),s(ra),s(Me);var Re=i(Me,2),De=i(l(Re),4),ca=i(l(De),2),ve=l(ca);g(()=>{e(z),L(()=>{e(A)})}),fe(ve,5,()=>e(A),me,(t,o)=>{var d=Ei(),m=l(d,!0);s(d);var n={};g(()=>{f(m,e(o).name),n!==(n=e(o).name)&&(d.value=(d.__value=e(o).name)??"")}),y(t,d)}),s(ve);var de=i(ve,2),ri=l(de,!0);s(de),s(ca),s(De);var Ge=i(De,2),va=l(Ge),Oe=l(va),da=i(l(Oe),2);_(da),s(Oe);var pa=i(Oe,2),pe=l(pa),ci=l(pe,!0);s(pe),s(pa),s(va),s(Ge);var vi=i(Ge,2);{var di=t=>{var o=Mi(),d=l(o);fe(d,5,()=>e(A),me,(m,n)=>{var p=Fi(),j=hi(p),C=l(j),O=l(C,!0);s(C);var V=i(C,2),se=l(V);s(V),s(j);var J=i(j,2),k=l(J);s(J),g(()=>{f(O,e(n).name),f(se,`${e(n).video_codec??""} ‚Ä¢ ${e(n).audio_codec??""} ‚Ä¢ ${e(n).preset??""} ‚Ä¢ ${e(n).target_mb??""}MB`),k.disabled=e(r)}),w("click",k,()=>Ga(e(n).name)),y(m,p)}),s(d),s(o),y(t,o)};N(vi,t=>{e(A).length&&t(di)})}s(Re);var Je=i(Re,2),ua=i(l(Je),4),Le=l(ua),ba=i(l(Le),2);_(ba),s(Le);var _a=i(Le,2),ue=l(_a),pi=l(ue,!0);s(ue),s(_a),s(ua),s(Je);var Qe=i(Je,2),fa=i(l(Qe),4),Xe=l(fa),ma=i(l(Xe),2);_(ma),s(Xe);var ya=i(Xe,2),be=l(ya),ui=l(be,!0);s(be),s(ya),s(fa),x(2),s(Qe);var ha=i(Qe,2),Ke=i(l(ha),2),ga=i(l(Ke),2);_(ga),s(Ke);var We=i(Ke,2),$e=l(We),Ye=i(l($e),2);g(()=>{e(M),L(()=>{})});var Ze=l(Ye);Ze.value=Ze.__value="av1_nvenc";var et=i(Ze);et.value=et.__value="hevc_nvenc";var tt=i(et);tt.value=tt.__value="h264_nvenc";var at=i(tt);at.value=at.__value="libaom-av1";var it=i(at);it.value=it.__value="libx265";var xa=i(it);xa.value=xa.__value="libx264",s(Ye),s($e);var wa=i($e,2),st=i(l(wa),2);g(()=>{e(q),L(()=>{})});var lt=l(st);lt.value=lt.__value="libopus";var ka=i(lt);ka.value=ka.__value="aac",s(st),s(wa),s(We);var ot=i(We,2),nt=l(ot),rt=i(l(nt),2);g(()=>{e(I),L(()=>{})});var ct=l(rt);ct.value=ct.__value="p1";var vt=i(ct);vt.value=vt.__value="p2";var dt=i(vt);dt.value=dt.__value="p3";var pt=i(dt);pt.value=pt.__value="p4";var ut=i(pt);ut.value=ut.__value="p5";var bt=i(ut);bt.value=bt.__value="p6";var Sa=i(bt);Sa.value=Sa.__value="p7",s(rt),s(nt);var ja=i(nt,2),_t=i(l(ja),2);g(()=>{e(B),L(()=>{})});var ft=l(_t);ft.value=ft.__value=64;var mt=i(ft);mt.value=mt.__value=96;var yt=i(mt);yt.value=yt.__value=128;var ht=i(yt);ht.value=ht.__value=160;var gt=i(ht);gt.value=gt.__value=192;var Pa=i(gt);Pa.value=Pa.__value=256,s(_t),s(ja),s(ot);var xt=i(ot,2),wt=l(xt),kt=i(l(wt),2);g(()=>{e(R),L(()=>{})});var St=l(kt);St.value=St.__value="mp4";var Ca=i(St);Ca.value=Ca.__value="mkv",s(kt),s(wt);var Na=i(wt,2),jt=i(l(Na),2);g(()=>{e(D),L(()=>{})});var Pt=l(jt);Pt.value=Pt.__value="hq";var Ct=i(Pt);Ct.value=Ct.__value="ll";var Nt=i(Ct);Nt.value=Nt.__value="ull";var Aa=i(Nt);Aa.value=Aa.__value="lossless",s(jt),s(Na),s(xt);var Va=i(xt,2),_e=l(Va),bi=l(_e,!0);s(_e),s(Va),s(ha),x(2),s(he),g(()=>{re.disabled=e(r),f(Ya,e(r)?"Saving‚Ä¶":"Save codec settings"),ae.disabled=e(ee),f(ei,e(ee)?"Running‚Ä¶":"Re-run hardware tests"),aa.disabled=e(ee),ie.disabled=e(r),f(si,e(r)?"Saving‚Ä¶":"Save history settings"),na.disabled=e(r),ce.disabled=e(r),f(ni,e(r)?"Saving‚Ä¶":"Save size buttons"),de.disabled=e(r),f(ri,e(r)?"Saving‚Ä¶":"Set default"),pe.disabled=e(r),f(ci,e(r)?"Saving‚Ä¶":"Add from current defaults"),ue.disabled=e(r),f(pi,e(r)?"Saving‚Ä¶":"Save retention"),be.disabled=e(r),f(ui,e(r)?"Saving‚Ä¶":"Save concurrency"),_e.disabled=e(r),f(bi,e(r)?"Saving‚Ä¶":"Save defaults")}),S(Et,()=>e(v).av1_nvenc,t=>P(v,e(v).av1_nvenc=t)),S(Ft,()=>e(v).hevc_nvenc,t=>P(v,e(v).hevc_nvenc=t)),S(qt,()=>e(v).h264_nvenc,t=>P(v,e(v).h264_nvenc=t)),S(Bt,()=>e(v).av1_qsv,t=>P(v,e(v).av1_qsv=t)),S(Rt,()=>e(v).hevc_qsv,t=>P(v,e(v).hevc_qsv=t)),S(Gt,()=>e(v).h264_qsv,t=>P(v,e(v).h264_qsv=t)),S(Jt,()=>e(v).av1_vaapi,t=>P(v,e(v).av1_vaapi=t)),S(Lt,()=>e(v).hevc_vaapi,t=>P(v,e(v).hevc_vaapi=t)),S(Xt,()=>e(v).h264_vaapi,t=>P(v,e(v).h264_vaapi=t)),S(Wt,()=>e(v).libaom_av1,t=>P(v,e(v).libaom_av1=t)),S($t,()=>e(v).libx265,t=>P(v,e(v).libx265=t)),S(Zt,()=>e(v).libx264,t=>P(v,e(v).libx264=t)),w("click",re,Ma),w("click",ae,za),w("click",aa,async()=>{try{const t=await fetch("/api/system/encoder-tests");if(t.ok){const o=await t.json();a($,o.results||[]),a(b,"Loaded latest test results")}}catch{}}),S(ia,()=>e(Y),t=>a(Y,t)),w("click",ie,qa),E(la,()=>e(X),t=>a(X,t)),w("click",na,Ra),w("click",ce,Ia),Q(ve,()=>e(z),t=>a(z,t)),w("click",de,Oa),E(da,()=>e(K),t=>a(K,t)),w("click",pe,Da),E(ba,()=>e(ne),t=>a(ne,t)),w("click",ue,Ja),E(ma,()=>e(W),t=>a(W,t)),w("click",be,La),E(ga,()=>e(F),t=>a(F,t)),Q(Ye,()=>e(M),t=>a(M,t)),Q(st,()=>e(q),t=>a(q,t)),Q(rt,()=>e(I),t=>a(I,t)),Q(_t,()=>e(B),t=>a(B,t)),Q(kt,()=>e(R),t=>a(R,t)),Q(jt,()=>e(D),t=>a(D,t)),w("click",_e,Fa),y(Ha,he),yi()}export{Xi as component};
