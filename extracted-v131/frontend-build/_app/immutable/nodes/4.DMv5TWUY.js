import{f as _,a as c,c as Y}from"../chunks/BZqCPlBW.js";import"../chunks/CS0-jjX0.js";import{o as cs}from"../chunks/BPGtCBdR.js";import{k as fs,b as ps,aj as _s,h as ee,Z as xs,$ as us,a8 as we,f as ye,d as ke,m as ms,F as bs,K as hs,J as r,I as s,ak as gs,P as e,z as t,M as H,N as u,D as T,G as b}from"../chunks/U2DDJ_0W.js";import{e as z,s as n}from"../chunks/CY5WxPnE.js";import{i as m}from"../chunks/DI9HNUez.js";import{e as ws,s as ys,i as ks}from"../chunks/C9DCMbO9.js";import{i as Es}from"../chunks/CQGLq4BK.js";import{g as Ee}from"../chunks/EcE7eIBB.js";function Fs(A,j){let x=null,F=ee;var h;if(ee){x=ms;for(var d=xs(document.head);d!==null&&(d.nodeType!==us||d.data!==A);)d=we(d);if(d===null)ye(!1);else{var L=we(d);d.remove(),ke(L)}}ee||(h=document.head.appendChild(fs()));try{ps(()=>j(h),_s)}finally{F&&(ye(!0),ke(x))}}var $s=_('<div class="loading svelte-1xl2tfr">Loading history...</div>'),Ds=_('<div class="error svelte-1xl2tfr"> </div>'),Cs=_('<div class="info-box svelte-1xl2tfr"><p class="svelte-1xl2tfr">ğŸ“Š History tracking is currently disabled.</p> <p class="svelte-1xl2tfr">Enable it in <a href="/settings" class="link svelte-1xl2tfr">Settings</a> to track your compression jobs.</p></div>'),Ms=_('<div class="info-box svelte-1xl2tfr"><p class="svelte-1xl2tfr">No compression history yet.</p> <p class="svelte-1xl2tfr">Complete a compression job to see it here!</p></div>'),Hs=_('<div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Tune:</span> <span class="badge svelte-1xl2tfr"> </span></div>'),Ts=_('<div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Container:</span> <span class="badge svelte-1xl2tfr"> </span></div>'),zs=_('<div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Audio kbps:</span> <span class="badge svelte-1xl2tfr"> </span></div>'),As=_('<div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Encoder:</span> <span class="badge svelte-1xl2tfr"> </span></div>'),js=_('<div class="codec-info svelte-1xl2tfr"><div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Max WxH:</span> <span class="badge svelte-1xl2tfr"> </span></div> <div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Trim:</span> <span class="badge svelte-1xl2tfr"> </span></div></div>'),Ls=_('<div class="history-entry svelte-1xl2tfr"><div class="entry-main svelte-1xl2tfr"><div class="entry-info svelte-1xl2tfr"><h3 class="filename svelte-1xl2tfr"> </h3> <p class="timestamp svelte-1xl2tfr"> </p></div> <div class="size-info svelte-1xl2tfr"><div class="size-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Original:</span> <span class="value svelte-1xl2tfr"> </span></div> <div class="size-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Compressed:</span> <span class="value svelte-1xl2tfr"> </span></div> <div class="size-row reduction svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Reduction:</span> <span class="value highlight svelte-1xl2tfr"> </span></div></div> <div class="codec-info svelte-1xl2tfr"><div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Video:</span> <span class="badge svelte-1xl2tfr"> </span></div> <div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Audio:</span> <span class="badge svelte-1xl2tfr"> </span></div> <div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Preset:</span> <span class="badge svelte-1xl2tfr"> </span></div> <!> <!> <!> <!> <div class="codec-row svelte-1xl2tfr"><span class="label svelte-1xl2tfr">Time:</span> <span class="badge svelte-1xl2tfr"> </span></div></div> <!></div> <div class="entry-actions svelte-1xl2tfr"><a class="btn-secondary svelte-1xl2tfr" target="_blank" rel="noopener">â¬‡ï¸ Download</a> <button class="btn-delete svelte-1xl2tfr">ğŸ—‘ï¸ Delete</button></div></div>'),Ns=_('<div class="history-header svelte-1xl2tfr"><p class="entry-count svelte-1xl2tfr"> </p> <button class="btn-danger svelte-1xl2tfr">ğŸ—‘ï¸ Clear All</button></div> <div class="history-list svelte-1xl2tfr"></div>',1),Os=_('<div class="container svelte-1xl2tfr"><div class="header svelte-1xl2tfr"><h1 class="svelte-1xl2tfr">ğŸ“œ Compression History</h1> <div class="actions svelte-1xl2tfr"><button class="btn-secondary svelte-1xl2tfr">âš™ï¸ Settings</button> <button class="btn-secondary svelte-1xl2tfr">ğŸ  Home</button></div></div> <!></div>');function Vs(A,j){bs(j,!1);let x=H([]),F=H(!1),h=H(!0),d=H("");async function L(){u(h,!0),u(d,"");try{const a=await fetch("/api/history");if(!a.ok)throw new Error("Failed to fetch history");const f=await a.json();u(x,f.entries||[]),u(F,f.enabled)}catch(a){u(d,a instanceof Error?a.message:"Unknown error")}finally{u(h,!1)}}async function Fe(){if(confirm("Are you sure you want to clear all compression history?"))try{if(!(await fetch("/api/history",{method:"DELETE"})).ok)throw new Error("Failed to clear history");u(x,[])}catch(a){u(d,a instanceof Error?a.message:"Failed to clear history")}}async function $e(a){try{if(!(await fetch(`/api/history/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to delete entry");u(x,t(x).filter(E=>E.task_id!==a))}catch(f){u(d,f instanceof Error?f.message:"Failed to delete entry")}}function De(a){return new Date(a).toLocaleString()}function Ce(a){if(a<60)return`${a.toFixed(1)}s`;const f=Math.floor(a/60),E=Math.floor(a%60);return`${f}m ${E}s`}function $(a){return a==null||a===""?"â€”":String(a)}function Me(a){return`/api/jobs/${encodeURIComponent(a)}/download`}cs(L),Es();var N=Os();Fs("1xl2tfr",a=>{gs.title="Compression History - 8mb.local"});var O=s(N),se=r(s(O),2),te=s(se),He=r(te,2);e(se),e(O);var Te=r(O,2);{var ze=a=>{var f=$s();c(a,f)},Ae=a=>{var f=Y(),E=T(f);{var je=g=>{var w=Ds(),S=s(w,!0);e(w),b(()=>n(S,t(d))),c(g,w)},Le=g=>{var w=Y(),S=T(w);{var Ne=y=>{var D=Cs();c(y,D)},Oe=y=>{var D=Y(),Se=T(D);{var Ue=k=>{var C=Ms();c(k,C)},Be=k=>{var C=Ns(),U=T(C),B=s(U),Pe=s(B);e(B);var Re=r(B,2);e(U);var ae=r(U,2);ws(ae,5,()=>t(x),ks,(Ge,l)=>{var P=Ls(),R=s(P),G=s(R),I=s(G),Ie=s(I);e(I);var re=r(I,2),Je=s(re);e(re),e(G);var J=r(G,2),K=s(J),le=r(s(K),2),Ke=s(le);e(le),e(K);var V=r(K,2),ie=r(s(V),2),Ve=s(ie);e(ie),e(V);var ve=r(V,2),oe=r(s(ve),2),We=s(oe);e(oe),e(ve),e(J);var W=r(J,2),Z=s(W),ne=r(s(Z),2),Ze=s(ne,!0);e(ne),e(Z);var q=r(Z,2),de=r(s(q),2),qe=s(de,!0);e(de),e(q);var Q=r(q,2),ce=r(s(Q),2),Qe=s(ce,!0);e(ce),e(Q);var fe=r(Q,2);{var Xe=i=>{var v=Hs(),o=r(s(v),2),p=s(o,!0);e(o),e(v),b(()=>n(p,t(l).tune)),c(i,v)};m(fe,i=>{t(l).tune&&i(Xe)})}var pe=r(fe,2);{var Ye=i=>{var v=Ts(),o=r(s(v),2),p=s(o,!0);e(o),e(v),b(()=>n(p,t(l).container)),c(i,v)};m(pe,i=>{t(l).container&&i(Ye)})}var _e=r(pe,2);{var es=i=>{var v=zs(),o=r(s(v),2),p=s(o,!0);e(o),e(v),b(()=>n(p,t(l).audio_bitrate_kbps)),c(i,v)};m(_e,i=>{t(l).audio_bitrate_kbps&&i(es)})}var xe=r(_e,2);{var ss=i=>{var v=As(),o=r(s(v),2),p=s(o,!0);e(o),e(v),b(()=>n(p,t(l).encoder)),c(i,v)};m(xe,i=>{t(l).encoder&&i(ss)})}var ue=r(xe,2),me=r(s(ue),2),ts=s(me,!0);e(me),e(ue),e(W);var as=r(W,2);{var rs=i=>{var v=js(),o=s(v),p=r(s(o),2),X=s(p);e(p),e(o);var M=r(o,2),ge=r(s(M),2),is=s(ge);e(ge),e(M),e(v),b((vs,os,ns,ds)=>{n(X,`${vs??""}Ã—${os??""}`),n(is,`${ns??""} â†’ ${ds??""}`)},[()=>$(t(l).max_width),()=>$(t(l).max_height),()=>$(t(l).start_time),()=>$(t(l).end_time)]),c(i,v)};m(as,i=>{(t(l).max_width||t(l).max_height||t(l).start_time||t(l).end_time)&&i(rs)})}e(R);var be=r(R,2),he=s(be),ls=r(he,2);e(be),e(P),b((i,v,o,p,X,M)=>{n(Ie,`ğŸ“¹ ${t(l).filename??""}`),n(Je,`ğŸ• ${i??""}`),n(Ke,`${v??""} MB`),n(Ve,`${o??""} MB`),n(We,`${p??""}% smaller`),n(Ze,t(l).video_codec),n(qe,t(l).audio_codec),n(Qe,t(l).preset),n(ts,X),ys(he,"href",M)},[()=>De(t(l).timestamp),()=>t(l).original_size_mb.toFixed(2),()=>t(l).compressed_size_mb.toFixed(2),()=>t(l).reduction_percent.toFixed(1),()=>Ce(t(l).duration_seconds),()=>Me(t(l).task_id)]),z("click",ls,()=>$e(t(l).task_id)),c(Ge,P)}),e(ae),b(()=>n(Pe,`${t(x).length??""} ${t(x).length===1?"entry":"entries"}`)),z("click",Re,Fe),c(k,C)};m(Se,k=>{t(x).length===0?k(Ue):k(Be,!1)},!0)}c(y,D)};m(S,y=>{t(F)?y(Oe,!1):y(Ne)},!0)}c(g,w)};m(E,g=>{t(d)?g(je):g(Le,!1)},!0)}c(a,f)};m(Te,a=>{t(h)?a(ze):a(Ae,!1)})}e(N),z("click",te,()=>Ee("/settings")),z("click",He,()=>Ee("/")),c(A,N),hs()}export{Vs as component};
